<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculating the score distribution given ability â€¢ dexter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Calculating the score distribution given ability">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">dexter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../../articles/dexter.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/DIF_vignette.html">Exploring Differential Items Functioning with Dexter</a>
    </li>
    <li>
      <a href="../../articles/Equating.html">Equating a Pass-Fail Score</a>
    </li>
    <li>
      <a href="../../articles/Plausible_Values.html">Plausible Values in Dexter</a>
    </li>
    <li>
      <a href="../../articles/profile-plots.html">How Members of Different Groups Obtain the Same Test Score: Profile Plots in Dexter</a>
    </li>
    <li>
      <a href="../../articles/Test_Individual_differences.html">One theta to rule them all: Test Individual Differences</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/blog/index.html">Blog</a>
</li>
<li>
  <a href="../../articles/blog/about.html">About</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dexter-psychometrics/dexter" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculating the score distribution given
ability</h1>
                        <h4 data-toc-skip class="author">Timo
Bechger</h4>
            
            <h4 data-toc-skip class="date">2020-05-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dexter-psychometrics/dexter/blob/master/vignettes/blog/2020-05-15-calculating-the-score-distribution-giving-ability.Rmd" class="external-link"><code>vignettes/blog/2020-05-15-calculating-the-score-distribution-giving-ability.Rmd</code></a></small>
      <div class="hidden name"><code>2020-05-15-calculating-the-score-distribution-giving-ability.Rmd</code></div>

    </div>

    
    
<p><b>[A muggle preface by Ivailo]</b> <i>As every fantasy lover knows,
IRT people belong to two towers, or is it schools of magic. The little
wizards and witches of one school learn to condition on their sufficient
statistics before they can even fly or play quidditch, while at the
other school they will integrate out anything thrown at them.</i></p>
<p>The two approaches have their subtle differences. To predict the
score distribution conditional on ability, wizards at the first school
apply the same powerful curse, elementary symmetric functions, that they
use for all kinds of magic â€“ from catching dragons over estimating
parameters, up to item-total and item-rest regressions, to mention but a
few. At the second school, computing the score distribution used to be a
frustrating task until <span class="citation">Lord and Wingersky
(1984)</span> came up with a seemingly unrelated jinx that did the
trick.</p>
<p>In what follows, Timo explains how the two kinds of magic relate to
each other.</p>
<p>Consider the Rasch model. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_{i}</annotation></semantics></math>
denote the binary-coded response to item
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and assume that:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ</mo><mi>i</mi></munder><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>t</mi><msub><mi>x</mi><mo>+</mo></msub></msup><munder><mo>âˆ</mo><mi>i</mi></munder><msubsup><mi>b</mi><mi>i</mi><msub><mi>x</mi><mi>i</mi></msub></msubsup></mrow><mrow><munder><mo>âˆ</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>t</mi><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p(\mathbf{x}|t,\mathbf{b}) =\prod_i p(x_{i}|t,b_i) =\frac{t^{x_+} \prod_i b^{x_{i}}_i}{\prod_i (1 + t b_i)}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation></semantics></math>
is person ability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math>
the difficulty of item
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mo>+</mo></msub><annotation encoding="application/x-tex">x_+</annotation></semantics></math>
the number of correct answers. Conditional on the personâ€™s ability and
the item difficulties, the test score distribution is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mo>+</mo></msub><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>ğ±</mi><mo>:</mo><msub><mi>x</mi><mo>+</mo></msub><mo>=</mo><mi>s</mi></mrow></munder><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>t</mi><mi>s</mi></msup><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>âˆ</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>t</mi><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
P(X_+=s|t, \mathbf{b}) = \sum_{\mathbf{x} : x_+ = s} p(\mathbf{x}|t,\mathbf{b}) =\frac{t^s \gamma_s(\boldsymbol{b})}{\prod_i (1+t b_i)},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>ğ±</mi><mo>:</mo><msub><mi>x</mi><mo>+</mo></msub><mo>=</mo><mi>s</mi></mrow></msub><msub><mo>âˆ</mo><mi>i</mi></msub><msubsup><mi>b</mi><mi>i</mi><msub><mi>x</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">\gamma_s(\boldsymbol{b}) = \sum_{\mathbf{x} : x_+ = s} \prod_i b_i^{x_i}</annotation></semantics></math>
is the <em>elementary symmetric function (esf)</em> of order
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
of the item parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo>,</mo><msub><mi>b</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>b</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{b}=(b_1,b_2,\dots, b_m)</annotation></semantics></math>.</p>
<p>Thus, the esf arise naturally when one works with Rasch models. They
appear when we expand a linear factorization of a monic polynomial. More
specifically, since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mi>s</mi></msub><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mo>+</mo></msub><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">|</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_s P(X_+=s|\theta)=1</annotation></semantics></math>,
we find the identity:<br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>t</mi><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></munderover><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>t</mi><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">
\prod^m_{i=1} (1+tb_i)
=\sum^m_{s=0} \gamma_s(\boldsymbol{b}) t^s
</annotation></semantics></math> which is a generalization of Newtonâ€™s
binomial theorem where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›</mi><mo>=</mo><mn>ğŸ</mn></mrow><annotation encoding="application/x-tex">\mathbf{b} = \mathbf{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>ğŸ</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>m</mi><mi>s</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma_s(\mathbf{1}) = {m \choose s}</annotation></semantics></math>.</p>
<p>The notation can be adapted to also handle items with more than two
score categories. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
denote the dummy-coded response to item
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;
that is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y_{ij}=1</annotation></semantics></math>
category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">j \in \{0,\dots, m_i\}</annotation></semantics></math>
of item
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is picked and zero otherwise. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math>
denote the number of points earned for a response in category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mn>0</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_{i0}=0</annotation></semantics></math>.
The IRT model becomes
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ</mo><mi>i</mi></munder><mfrac><mrow><munder><mo>âˆ</mo><mi>j</mi></munder><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>t</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup></mrow><mrow><munder><mo>âˆ‘</mo><mi>j</mi></munder><msup><mi>t</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p(\mathbf{y}|t,\mathbf{b}) = \prod_i \frac{\prod_j \left( t^{a_{ij}}b_{ij}\right)^{y_{ij}}}{\sum_j t^{a_{ij}}b_{ij}}
</annotation></semantics></math></p>
<p>This is a nominal response model with fixed integer item-category
scores. We use the letter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
for the item parameters but note that we have included a dummy parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>i</mi><mn>0</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b_{i0}=1</annotation></semantics></math>
for the lowest category. For a dichotomous item,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m_i=1</annotation></semantics></math>,
so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">j\in\{0,1\}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mn>0</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_{i0}=0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_{i1}=1</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_{i1}=b_i</annotation></semantics></math>.</p>
<p>Using this notation, the test score distribution is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>t</mi><msub><mi>y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub></msup><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>âˆ</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><msup><mi>t</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
P(Y_{++}=s|t, \mathbf{b}) = \frac{t^{y_{++}} \gamma_s(\boldsymbol{b})}{\prod_i \left(\sum_j t^{a_{ij}}b_{ij}\right)},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub><mo>=</mo><msub><mo>âˆ‘</mo><mi>i</mi></msub><msub><mo>âˆ‘</mo><mi>j</mi></msub><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>x</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">y_{++}=\sum_i \sum_j a_{ij} y_{ij} = x_+</annotation></semantics></math>.
and esf are defined as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>ğ²</mi><mo>:</mo><msub><mi>y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub><mo>=</mo><mi>s</mi></mrow></munder><munder><mo>âˆ</mo><mi>i</mi></munder><munder><mo>âˆ</mo><mi>j</mi></munder><msubsup><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msubsup></mrow><annotation encoding="application/x-tex">
\gamma_s(\mathbf{b}) = \sum_{\mathbf{y}:y_{++}=s} \prod_i \prod_j b^{y_{ij}}_{ij}
</annotation></semantics></math> It follows that:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>m</mi><mi>i</mi></msub></munderover><msup><mi>t</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow><mi>M</mi></munderover><msup><mi>t</mi><mi>s</mi></msup><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\prod^m_{i=1} \left(1+\sum^{m_i}_{j=1} t^{a_{ij}}b_{ij}\right) = \sum^{M}_{s=0} t^{s} \gamma_s(\boldsymbol{b})
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
now runs over values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub><annotation encoding="application/x-tex">y_{++}</annotation></semantics></math>;
that is, from zero to the highest test score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mo>âˆ‘</mo><mi>i</mi></msub><msub><mi>a</mi><mrow><mi>i</mi><msub><mi>m</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">M=\sum_i a_{im_i}</annotation></semantics></math>.</p>
<p>To illustrate, consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m=2</annotation></semantics></math>
items with three categores each; that is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m_i=2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_{i1}=1</annotation></semantics></math>.
Writing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î³</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\gamma_s</annotation></semantics></math>
as short-hand for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma_s(\mathbf{b})</annotation></semantics></math>
the above identity says:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>t</mi><msub><mi>a</mi><mn>11</mn></msub></msup><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><msup><mi>t</mi><msub><mi>a</mi><mn>21</mn></msub></msup><msub><mi>b</mi><mn>21</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>t</mi><msub><mi>a</mi><mn>11</mn></msub></msup><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><msup><mi>t</mi><msub><mi>a</mi><mn>21</mn></msub></msup><msub><mi>b</mi><mn>21</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î³</mi><mn>0</mn></msub><msup><mi>t</mi><mn>0</mn></msup><mo>+</mo><msub><mi>Î³</mi><mn>1</mn></msub><msup><mi>t</mi><mn>1</mn></msup><mo>+</mo><msub><mi>Î³</mi><mn>2</mn></msub><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><msup><mi>t</mi><mn>3</mn></msup><msub><mi>Î³</mi><mn>3</mn></msub><mo>+</mo><msub><mi>Î³</mi><mn>4</mn></msub><msup><mi>t</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
\left(1+t^{a_{11}}b_{11} + t^{a_{21}}b_{21}\right)
\left(1+t^{a_{11}}b_{11} + t^{a_{21}}b_{21}\right)=
\gamma_0 t^0 + \gamma_1 t^1 + \gamma_2 t^2 + t^3 \gamma_3 + \gamma_4 t^2
</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Î³</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mtext mathvariant="normal">(by definition)</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Î³</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Î³</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>b</mi><mn>22</mn></msub><mo>+</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>21</mn></msub><mo>+</mo><msub><mi>b</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Î³</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>22</mn></msub><mo>+</mo><msub><mi>b</mi><mn>12</mn></msub><msub><mi>b</mi><mn>21</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Î³</mi><mn>4</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>b</mi><mn>12</mn></msub><msub><mi>b</mi><mn>21</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\gamma_0 &amp;=1 \text{(by definition)}\\
\gamma_1 &amp;=b_{11}+b_{21}\\
\gamma_2 &amp;=b_{22}+b_{11}b_{21}+b_{12}\\
\gamma_3 &amp;=b_{11}b_{22}+b_{12}b_{21} \\
\gamma_4 &amp;=b_{12}b_{21}
\end{align*}</annotation></semantics></math> Looking at the subscripts,
an easy trick is:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î³</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\gamma_s</annotation></semantics></math>
is the sum of the products of item parameters over all possible ways to
obtain a score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.
For example, a score of 2 can be obtained by a score of 2 on item 2, a
score of 1 on both items or a score of 2 on item 1. Note that, for any
score that is impossible, the corresponding esf is set to zero.</p>
<p>The esf are sums of products and calculating these is not trivial as
rounding errors tend to accumulate. Fortunately, the esf satisfy the
following recursive relation:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><msub><mi>m</mi><mi>i</mi></msub></munderover><msub><mi>Î³</mi><mrow><mi>s</mi><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
 \gamma_s(\mathbf{b})
 =
 \sum^{m_i}_{j=0} \gamma_{s-a_{ij}}(\mathbf{b}^{(i)}) b_{ij},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ›</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\mathbf{b}^{(i)}</annotation></semantics></math>
denotes the item parameters excluding the parameters that belong to item
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
This recursion is the basis for a numerically stable algorithm known as
<em>the sum (or summation)-algorithm</em>. Proposed by <span class="citation">Andersen (1972)</span>, this algorithm is implemented
in dexterâ€™s <strong>elsym</strong> function.</p>
<p>We illustrate the sum-algorithm with three Rasch items ordered in an
arbitrary way. We begin the recursion with the first item:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><mo>=</mo><msub><mi>b</mi><mn>10</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma^{[1]}_0 = b_{10} = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">\gamma^{[1]}_1 = b_{11}</annotation></semantics></math>,
where the superscript indicates the number of items. Then, we add the
second item:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>20</mn></msub><mo>=</mo><msub><mi>b</mi><mn>10</mn></msub><msub><mi>b</mi><mn>20</mn></msub><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>20</mn></msub><mo>+</mo><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>21</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>20</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub><msub><mi>b</mi><mn>10</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>21</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>21</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\gamma^{[2]}_0 &amp;= \gamma^{[1]}_{0}b_{20} = b_{10}b_{20} = 1\\
\gamma^{[2]}_1 &amp;= \gamma^{[1]}_{1}b_{20} + \gamma^{[1]}_{0}b_{21} = b_{11}b_{20} + b_{21}b_{10}=b_{11}+b_{21}\\
\gamma^{[2]}_2 &amp;=  \gamma^{[1]}_{1}b_{21} = b_{11}b_{21}
\end{align*}</annotation></semantics></math> Finally, we add the third
item:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>3</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>30</mn></msub><mo>=</mo><msub><mi>b</mi><mn>10</mn></msub><msub><mi>b</mi><mn>20</mn></msub><msub><mi>b</mi><mn>30</mn></msub><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>3</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>30</mn></msub><mo>+</mo><msubsup><mi>Î³</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>20</mn></msub><msub><mi>b</mi><mn>30</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub><msub><mi>b</mi><mn>10</mn></msub><msub><mi>b</mi><mn>30</mn></msub><mo>+</mo><msub><mi>b</mi><mn>10</mn></msub><msub><mi>b</mi><mn>20</mn></msub><msub><mi>b</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub><mo>+</mo><msub><mi>b</mi><mn>31</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>3</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>30</mn></msub><mo>+</mo><msubsup><mi>Î³</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>21</mn></msub><msub><mi>b</mi><mn>30</mn></msub><mo>+</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>20</mn></msub><msub><mi>b</mi><mn>31</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub><msub><mi>b</mi><mn>10</mn></msub><msub><mi>b</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>21</mn></msub><mo>+</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>31</mn></msub><mo>+</mo><msub><mi>b</mi><mn>21</mn></msub><msub><mi>b</mi><mn>31</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>Î³</mi><mn>3</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>3</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>Î³</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow></msubsup><msub><mi>b</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><msub><mi>b</mi><mn>21</mn></msub><msub><mi>b</mi><mn>31</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\gamma^{[3]}_0 &amp;= \gamma^{[2]}_{0}b_{30} = b_{10}b_{20}b_{30} =  1\\
\gamma^{[3]}_1 &amp;= \gamma^{[2]}_{1}b_{30} + \gamma^{[2]}_{0}b_{31} = b_{11}b_{20}b_{30} + b_{21}b_{10}b_{30} +b_{10}b_{20}b_{31} = b_{11}+b_{21}+b_{31}\\
\gamma^{[3]}_2 &amp;= \gamma^{[2]}_{2}b_{30} + \gamma^{[2]}_{1}b_{31} = b_{11}b_{21}b_{30}+b_{11}b_{20}b_{31} + b_{21}b_{10}b_{31} 
=b_{11}b_{21} + b_{11}b_{31} + b_{21}b_{31}\\
\gamma^{[3]}_3 &amp;= \gamma^{[2]}_{2}b_{31}  = b_{11}b_{21}b_{31}
\end{align*}</annotation></semantics></math></p>
<p>Now consider two ways to calculate the conditional test score
distribution. First, using the identity in the previous section, we can
write:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mo>+</mo></msub><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>t</mi><msub><mi>y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub></msup><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow><mi>M</mi></munderover><msup><mi>t</mi><mi>s</mi></msup><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p(X_+=s|t) = p(Y_{++}=s|t, \mathbf{b}) = \frac{t^{y_{++}} \gamma_s(\boldsymbol{b})}{\sum^M_{s=0} t^{s} \gamma_s(\mathbf{b})}
</annotation></semantics></math> This is the expression used by the
<strong>p_score</strong> function in dexter.</p>
<p>Second, we can also write:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mo>+</mo><mo>+</mo></mrow></msub><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>ğ²</mi><mo>:</mo><msub><mi>y</mi><mo>+</mo></msub><mo>=</mo><mi>s</mi></mrow></munder><munder><mo>âˆ</mo><mi>i</mi></munder><munder><mo>âˆ</mo><mi>j</mi></munder><msubsup><mi>Ï€</mi><mrow><mi>i</mi><mi>j</mi></mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msubsup><mo>=</mo><msub><mi>Î³</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›‘</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
P(Y_{++}=s|t, \mathbf{b}) = \sum_{\mathbf{y}:y_+ = s} \prod_i \prod_j \pi_{ij}^{y_{ij}} = \gamma_s(\boldsymbol{\pi})
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï€</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{ij}</annotation></semantics></math>
is short-hand for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(Y_{ij}=1|t) = p(X_i=j|t)</annotation></semantics></math>.
Written in this way, the test score distribution is an esf, albeit with
argument
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›‘</mi><annotation encoding="application/x-tex">\boldsymbol{\pi}</annotation></semantics></math>.
The following R function uses this observation to calculate the score
distribution:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LW</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Pi</span>, <span class="va">a</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">first</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">a</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">last</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">first</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">dexter</span><span class="fu">:::</span><span class="fu">elsym</span><span class="op">(</span><span class="va">Pi</span>,<span class="va">a</span>,<span class="va">first</span>,<span class="va">last</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <strong>elsym</strong> function is internal to
<strong>dexter</strong>, hence the three colons. This function actually
implements the Lord-Wingersky algorithm, extended to polytomous items.
Compared to the first solution, it has the advantage that it works for
any valid
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›‘</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Ï€</mi><mn>10</mn></msub><mo>,</mo><msub><mi>Ï€</mi><mn>11</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Ï€</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\pi}=(\pi_{10},\pi_{11},\dots, \pi_{m1})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš</mi><annotation encoding="application/x-tex">\mathbf{a}</annotation></semantics></math>
and could be used with any IRT model, not just the NRM implemented in
<strong>dexter</strong>.</p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-andersen1972numerical" class="csl-entry">
Andersen, Erling B. 1972. <span>â€œThe Numerical Solution of a Set of
Conditional Estimation Equations.â€</span> <em>Journal of the Royal
Statistical Society: Series B (Methodological)</em> 34 (1): 42â€“54.
</div>
<div id="ref-lord1984comparison" class="csl-entry">
Lord, Frederic M, and Marilyn S Wingersky. 1984. <span>â€œComparison of
IRT True-Score and Equipercentile Observed-Score Equatings.â€</span>
<em>Applied Psychological Measurement</em> 8 (4): 453â€“61.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gunter Maris, Timo Bechger, Jesse Koops, Ivailo Partchev.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
