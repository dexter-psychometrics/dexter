<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plausible Values in Dexter • dexter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Plausible Values in Dexter">
<meta property="og:description" content="dexter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dexter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dexter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DIF_vignette.html">Exploring Differential Items Functioning with Dexter</a>
    </li>
    <li>
      <a href="../articles/Equating.html">Equating a Pass-Fail Score</a>
    </li>
    <li>
      <a href="../articles/Plausible_Values.html">Plausible Values in Dexter</a>
    </li>
    <li>
      <a href="../articles/profile-plots.html">How Members of Different Groups Obtain the Same Test Score: Profile Plots in Dexter</a>
    </li>
    <li>
      <a href="../articles/Test_Individual_differences.html">One theta to rule them all: Test Individual Differences</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/blog/index.html">Blog</a>
</li>
<li>
  <a href="../articles/blog/about.html">About</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dexter-psychometrics/dexter" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plausible Values in Dexter</h1>
                        <h4 data-toc-skip class="author">Timo Bechger,
Jesse Koops and Ivailo Partchev</h4>
            
            <h4 data-toc-skip class="date">2023-03-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dexter-psychometrics/dexter/blob/HEAD/vignettes/Plausible_Values.Rmd" class="external-link"><code>vignettes/Plausible_Values.Rmd</code></a></small>
      <div class="hidden name"><code>Plausible_Values.Rmd</code></div>

    </div>

    
    
<style>
img{ border:none;}
</style>
<p>Plausible values are random samples from the posterior distribution
of ability. Dexter produces plausible values using a straightforward
rejection algorithm which was suggested by <span class="citation">Rubin
(1984)</span>, described and improved by <span class="citation">Maarten
Marsman et al. (2017)</span>, and applied in the SurveyLang project (<a href="http://www.surveylang.org/" class="external-link uri">http://www.surveylang.org/</a>).</p>
<p>To see how the algorithm works, one should note that the posterior of
ability can be defined as the collection of all values of ability that
might have generated the observations. This simple observation suggests
the following algorithm: sample a tentative ability from some
distribution, then simulate response data from the tentative ability and
the item parameters. Since the posterior depends only on the test score,
we repeat this until we hit an ability that produces the same expected
test score as the one observed for the person. This becomes the
plausible value for the person.</p>
<p>In the simple case where the test consists of e.g. 20 dichotomous
Rasch items with difficulty <span class="math inline">\(\delta\)</span>,
the following algorithm would produce one plausible value <span class="math inline">\(\theta\)</span> for a respondent with a test score
<span class="math inline">\(x_+=10\)</span>.</p>
<p style="background-color:#f7f7f7;line-height:1.5;padding:1em;">
<span class="math inline">\(y_+:=-1\)</span><br><span class="math inline">\(\mathbf{while}\ x_+ \neq y_+\
\mathbf{do}:\)</span><br><span class="math inline">\(\quad
y_+:=0\)</span><br><span class="math inline">\(\quad \mathbf{draw}\
\theta \sim \mathcal{N}(0,1)\)</span><br><span class="math inline">\(\quad \mathbf{for}\ i \ \mathbf{in}\
1:length(\mathbf{\delta}):\)</span><br><span class="math inline">\(\qquad \mathbf{draw}\ u \sim
logistic(0,1)\)</span><br><span class="math inline">\(\qquad
\mathbf{if}\ u \le \theta-\delta_i:\)</span><br><span class="math inline">\(\qquad \quad y_+ := y_+ + 1\)</span>
</p>
<p>The algorithm used by dexter is equivalent to the above in the
dichotomous case but it can handle polytomous items as well. The
user-level function is called <code>plausible_values</code>, and takes
as arguments the data source, the item parameters created by function
<code>fit_enorm</code>, and an optional predicate to select a subset of
the data. By judicious use of the predicate the user can do bizarre
things, such as estimate item parameters from one subset of the data and
apply them to compute plausible values for another subset.</p>
<p>Plausible values have been around for quite some time, and have been
made popular by many large scale educational surveys. Still, their full
potential is possibly underestimated. Having a reasonably fast program
such as dexter allows us to play around and demonstrate both the power
and the simplicity of the method.</p>
<p>We make a function to simulate a data set, estimate the item
parameters, draw 10 plausible values for each ‘person’, and compare
their empirical cumulative distribution function (ECDF, shown in gray)
with that of the true abilities (the black line):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_PV</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span>
<span>  <span class="va">sim_func</span> <span class="op">=</span> <span class="fu"><a href="../reference/information.html">r_score</a></span><span class="op">(</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>item_id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">nit</span>, item_score<span class="op">=</span><span class="fl">1</span>, delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">simulated_data</span> <span class="op">=</span> <span class="fu">sim_func</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>  <span class="va">parms</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_enorm.html">fit_enorm</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">)</span></span>
<span>  <span class="va">pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/plausible_values.html">plausible_values</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="va">parms</span>, nPV <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">-</span><span class="fl">.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span>, y<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, </span>
<span>       main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">nit</span>, <span class="st">"items"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'l'</span>, type<span class="op">=</span><span class="st">'n'</span>,</span>
<span>       xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">Fn</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pv</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'PV'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">.7</span>,<span class="fl">.7</span>,<span class="fl">.7</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">theta</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Let us try it out:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">sim_PV</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plausible_Values_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto;"></p>
<p>So far, so good. The true abilities were sampled from the standard
normal distribution, which was also used as the default prior in the
<code>plausible_values</code> function. To make things a bit more
exciting, we will generate true abilities from a markedly bi-modal
distribution whilst keeping a normal prior, which will be obviously
misspecified in this case. We will then examine the plausible value from
tests using the first 10, the first 20, and all 50 items simulated
above.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">300</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">grp</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="va">grp</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">'l'</span>,main<span class="op">=</span><span class="st">''</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plausible_Values_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">sim_PV</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">sim_PV</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">sim_PV</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plausible_Values_files/figure-html/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;"></p>
<p>The remarkable thing about plausible values is that they will
<em>eventually</em> reproduce the true distribution of ability: perhaps
sooner, if the prior is specified correctly, or later, if it is not. The
price that we had to pay in this example was merely administer a longer
test. For a more detailed discussion of this valuable property we refer
to <span class="citation">M. Marsman et al. (2016)</span>.</p>
<p>Observe that the gray bands are not wide, suggesting little
uncertainty in determining the ECDF of ability. It may be more realistic
to take the uncertainty in the item parameters into account. To do this,
we will use a Gibbs sampler to draw 50 samples from the posterior
distribution of the item parameters, and we will pick one of these at
random each time we produce a plausible value.</p>
<p>First, a little function to accomplish this; note the use of the
<code>use_draw</code> option which enables us to select every fifth
sample from the Gibbs sampler that produced the sample of item
parameters. Note that we have chosen every fifth sample to get rid of
(most of) the autocorrelation in the samples of item parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_PV2</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span>
<span>  <span class="va">sim_func</span> <span class="op">=</span> <span class="fu"><a href="../reference/information.html">r_score</a></span><span class="op">(</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>item_id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">nit</span>, item_score<span class="op">=</span><span class="fl">1</span>, delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">simulated_data</span> <span class="op">=</span> <span class="fu">sim_func</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>  <span class="va">parms</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_enorm.html">fit_enorm</a></span><span class="op">(</span><span class="va">simulated_data</span>, method<span class="op">=</span><span class="st">"Bayes"</span>, nDraws <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">-</span><span class="fl">.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span>, y<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">nit</span>, <span class="st">"items"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'l'</span>, type<span class="op">=</span><span class="st">'n'</span>,</span>
<span>       xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">Fn</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">which.draw</span> <span class="op">=</span> <span class="fl">5</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/plausible_values.html">plausible_values</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="va">parms</span>, use_draw<span class="op">=</span><span class="va">which.draw</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">pv</span><span class="op">$</span><span class="va">PV1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pv</span><span class="op">$</span><span class="va">PV1</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">.7</span>,<span class="fl">.7</span>,<span class="fl">.7</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">theta</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, try it out:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sim_PV2</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">sim_PV2</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">sim_PV2</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plausible_Values_files/figure-html/make_pv2-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The results show a small increase in variance but, with 300 persons,
the item parameters have been estimated very precisely. Note that the
user can accomplish the same goal by calling
<code>plausible_values</code> without parms.</p>
<p>To simulate abilities from a bi-modal distribution we assumed that
the data consist of two groups of subjects; each with a different
distribution of ability. To speed-up convergence to the true
distribution, dexter allow the user to specify a mixture of two normals
as a prior. A mixture of two normal distributions provides a flexible
prior that can be bimodal but also skewed. If we had been aware of the
presence of two groups we could have done even better by specifying a
different prior in each group. To this aim, the
<code>plausible_values</code> function has the option to provide
covariates. These covariates are assumed to be discrete and define
groups. Each group will be allowed a possibly different (normal) prior.
To show how this is done and also to illustrate that it is effective, we
now include the group-membership in the model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_PV3</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span>, <span class="va">group</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span>
<span>  <span class="va">sim_func</span> <span class="op">=</span> <span class="fu"><a href="../reference/information.html">r_score</a></span><span class="op">(</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>item_id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">nit</span>, item_score<span class="op">=</span><span class="fl">1</span>, delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">simulated_data</span> <span class="op">=</span> <span class="fu">sim_func</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>  <span class="va">parms</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_enorm.html">fit_enorm</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># because our data structure gets multi dimensional by the inclusion of groups</span></span>
<span>  <span class="co"># we  switch to a tidy format</span></span>
<span>  <span class="va">simulated_data</span> <span class="op">=</span> <span class="va">simulated_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>person_id<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span>, group<span class="op">=</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">'item_id'</span>, value<span class="op">=</span><span class="st">'item_score'</span>, <span class="op">-</span><span class="va">person_id</span>, <span class="op">-</span><span class="va">group</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="va">pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/plausible_values.html">plausible_values</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="va">parms</span>, covariates<span class="op">=</span><span class="st">'group'</span>,nPV <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">-</span><span class="fl">.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span>, y<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">nit</span>, <span class="st">"items"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'l'</span>, type<span class="op">=</span><span class="st">'n'</span>,</span>
<span>       xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">Fn</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pv</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'PV'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">.7</span>,<span class="fl">.7</span>,<span class="fl">.7</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">theta</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">sim_PV3</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,<span class="va">grp</span><span class="op">)</span></span>
<span><span class="fu">sim_PV3</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,<span class="va">grp</span><span class="op">)</span></span>
<span><span class="fu">sim_PV3</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span>,<span class="va">grp</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plausible_Values_files/figure-html/make_pv3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>It will be clear that the distribution of the plausible values
converges much faster (i.e., with fewer items) to the true distribution
of ability.</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-marsman2017turning" class="csl-entry">
Marsman, Maarten, Gunter Maris, Timo Bechger, and Cees Glas. 2017.
<span>“Turning Simulation into Estimation: Generalized Exchange
Algorithms for Exponential Family Models.”</span> <em>PloS One</em> 12
(1): e0169787.
</div>
<div id="ref-MarsmanPV" class="csl-entry">
Marsman, M., G. Maris, T. M. Bechger, and C. A. W. Glas. 2016.
<span>“<span class="nocase">What can we learn from plausible
values?</span>”</span> <em>Psychometrika</em>, 1–16.
</div>
<div id="ref-rubin1984bayesianly" class="csl-entry">
Rubin, Donald B. 1984. <span>“Bayesianly Justifiable and Relevant
Frequency Calculations for the Applied Statistician.”</span> <em>The
Annals of Statistics</em> 12 (4): 1151–72.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gunter Maris, Timo Bechger, Jesse Koops, Ivailo Partchev.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
